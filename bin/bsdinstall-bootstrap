#!/bin/sh

. _LIBRARY_PATH_/_APPLICATION_NAME_/bsdinstall/cli.sh

_INSTALLATION_PATH=$(mktemp -d)

_cleanup() {
	rm -rf _INSTALLATION_PATH
}

trap _cleanup INT 0 1 2 3 4

# prepare install script
. _LIBRARY_PATH_/_APPLICATION_NAME_/bsdinstall/bsdinstall.sh

# bring network device up so dhclient will work later
ifconfig $NET up

bsdinstall script $_INSTALLATION_SCRIPT

# copy bin/lib to ROOT dir so we can reboot and use it immmediately
tar cpf - /usr/local/walterjwhite | tar xpf - -C /mnt
while read _FILE
do
	cp /usr/local/bin/$_FILE /mnt/usr/local/bin
done < /usr/local/walterjwhite/freebsd-installer/.files

exitSuccess "####\nInstallation finished, please remove USB media and reboot\n\n\n\n"
